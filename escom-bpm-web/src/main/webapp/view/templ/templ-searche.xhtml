<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <h:outputScript library="js" name="clear-search.js" target="head"/>

    <script type="text/javascript" >
        function keyPress() {
            if (event.keyCode === 13) {
                document.getElementById('searcheBtn').click();
                return;
            }             
        }
    </script> 

    <p:defaultCommand target="eastFRM:searcheBtn" />
        
    <p:panelGrid columns="2" layout="grid" columnClasses="ui-grid-col-3 col-padding, ui-grid-col-9 col-padding" styleClass="ui-grid-col-12 without-spaces" >
        <p:panelGrid columns="2" id="abcGrid" layout="grid" columnClasses="ui-grid-col-6, ui-grid-col-6" styleClass="ui-grid-col-12 without-spaces">
            <p:commandButton value="*" title="#{bundle.StartAnyChars}" styleClass="btnABC"
                             actionListener="#{_bean.onAbcSearche}"
                             update="#{_tblUpdate}"
                             onstart="PF('statusDialog').show()"
                             oncomplete="PF('statusDialog').hide(); initDND();">
                <f:attribute name="action" value="#{'*'}" />
            </p:commandButton>
            <p:commandButton value="0-9" title="#{bundle.StartDigital}" style="width: 30px; font-size: 90%;"
                             actionListener="#{_bean.onAbcSearche}"
                             update="#{_tblUpdate}"
                             onstart="PF('statusDialog').show()"
                             oncomplete="PF('statusDialog').hide(); initDND();">
                <f:attribute name="action" value="#{'[0-9]'}" />
            </p:commandButton>

            <ui:repeat var="abcEngl" value="#{_bean.model.abcEnglSearche}">
                <p:commandButton value="#{abcEngl}" styleClass="btnABC"                       
                                actionListener="#{_bean.onAbcSearche}"
                                update="#{_tblUpdate}"
                                onstart="PF('statusDialog').show()"
                                oncomplete="PF('statusDialog').hide(); initDND();">
                    <f:attribute name="action" value="#{abcEngl}" />
                </p:commandButton>
            </ui:repeat>

            <ui:repeat var="abcLocal" value="#{_bean.model.abcLocalSearche}">
                <p:commandButton value="#{abcLocal}" styleClass="btnABC"
                                 actionListener="#{_bean.onAbcSearche}"
                                 update="#{_tblUpdate}"
                                 onstart="PF('statusDialog').show()"
                                 oncomplete="PF('statusDialog').hide(); initDND();">
                    <f:attribute name="action" value="#{abcLocal}" />
                </p:commandButton>
            </ui:repeat>
        </p:panelGrid>

        <p:panelGrid columns="1" layout="grid" columnClasses="ui-grid-col-12" styleClass="ui-grid-col-12 without-spaces">        
            <p:selectOneRadio value="#{_bean.model.searcheInGroups}" layout="pageDirection" rendered="#{_bean.treeBean != null}" styleClass="ui-grid-col-12">
                <f:selectItem itemLabel="#{bundle.SearcheWitchOutGroup}" itemValue="#{false}" />
                <f:selectItem itemLabel="#{bundle.SearcheInCurrentGroup}" itemValue="#{true}" />
            </p:selectOneRadio>

            <p:selectBooleanCheckbox itemLabel="#{bundle.SearcheOnlyActualItems}" 
                                     title="#{bundle.SearcheOnlyActualItemsComments}" 
                                     value="#{_bean.model.onlyActualItem}">
            </p:selectBooleanCheckbox> 
            
            <p:outputLabel value="#{bundle.KeyWord}:"/>
            <h:panelGroup styleClass="ui-grid-col-12">
                <div class="ui-inputgroup">
                    <p:inputText id="nameSearche" widgetVar="searchName" title="#{bundle.KeyWordSearche}"
                                 value="#{_bean.model.nameSearche}"
                                 styleClass="ui-grid-col-12"
                                 placeholder="#{bundle.InputCreteriaForSearche}"
                                 onkeypress="keyPress();">
                    </p:inputText>
                    <p:commandButton styleClass="btnClear" icon="ui-icon-close" onclick="PF('searchName').jq.val('');"/>
                </div>
            </h:panelGroup>

            <ui:insert name="searche"/>

            <p:outputLabel value="#{bundle.Owner}:"/>
            <h:panelGroup styleClass="ui-grid-col-12">
                <div class="ui-inputgroup">
                    <p:selectOneMenu value="#{_bean.model.authorSearche}" filter="true" converter="usersConvertor"
                                     widgetVar="authorSearche"
                                     styleClass="ui-grid-col-12">
                        <f:selectItems value="#{userBean.findAll()}" var="user" itemValue="#{user}" itemLabel="#{user.shortFIO}" />
                        <f:selectItem value="#{null}" itemLabel="#{bundle.NotSpecified}" itemValue="#{null}"/>
                    </p:selectOneMenu>
                    <p:commandButton styleClass="btnClear" icon="ui-icon-close" onclick="PF('authorSearche').selectValue();"/>
                </div>
            </h:panelGroup>

            <p:outputLabel value="#{bundle.States}:"/>
            <p:selectManyMenu id="stateChecks" value="#{_bean.model.stateSearche}" showCheckbox="true"
                              widgetVar="stateSearche" var="s"
                              label="#{bundle.Select}" converter="stateConvertor"
                              styleClass="ui-grid-col-12">
                <f:selectItems value="#{_searcheBean.metadatesObj.statesList}" var="state" itemLabel="#{stateBean.getBundleName(state)}" itemValue="#{state}"/>
                <p:column>
                    <h:outputText value="#{stateBean.getBundleName(s)}" />
                </p:column>
            </p:selectManyMenu>

            <p:selectBooleanCheckbox itemLabel="#{bundle.DateCreate}" id="cbDateCreate" 
                                     widgetVar="cbDateCreate"
                                     title="#{bundle.SearcheDateCreate}"  
                                     value="#{_bean.model.dateCreateSearche}">
                <p:ajax event="change" update="pnDateCreateSearche"/>
            </p:selectBooleanCheckbox>   

            <h:panelGroup id="pnDateCreateSearche" styleClass="ui-grid-col-12"> 
                <p:panelGrid columns="2" layout="grid" columnClasses="ui-grid-col-1, ui-grid-col-11" rendered="#{_bean.model.dateCreateSearche}" styleClass="ui-grid-col-12">
                    <p:outputLabel value="#{bundle.With}:" style="float: right;"/>
                    <p:calendar value="#{_bean.model.dateCreateStart}" id="dateCreateStart" 
                                widgetVar="dateCreateStartSearche"
                                navigator="true" yearRange="c-120:c+20"
                                locale="#{sessionBean.locale}"
                                required="#{_bean.model.dateCreateSearche and param['isRequired'] == 'true'}"
                                requiredMessage="#{bundle.Field} [#{bundle.DateCreate}: #{bundle.With}] #{bundle.MustBeFilled}"
                                disabled="#{!_bean.model.dateCreateSearche}">
                    </p:calendar>
                </p:panelGrid>
                <p:panelGrid columns="2" layout="grid" columnClasses="ui-grid-col-1, ui-grid-col-11" rendered="#{_bean.model.dateCreateSearche}" styleClass="ui-grid-col-12">
                    <p:outputLabel value="#{bundle.At}:" style="float: right;" />
                    <p:calendar value="#{_bean.model.dateCreateEnd}" id="dateCreateEnd" 
                                widgetVar="dateCreateEndSearche"
                                navigator="true" yearRange="c-120:c+20"
                                locale="#{sessionBean.locale}"
                                required="#{_bean.model.dateCreateSearche and param['isRequired'] == 'true'}"
                                requiredMessage="#{bundle.Field} [#{bundle.DateCreate}: #{bundle.At}] #{bundle.MustBeFilled}"
                                disabled="#{!_bean.model.dateCreateSearche}">
                    </p:calendar>
                </p:panelGrid>
            </h:panelGroup>
            
            <p:selectBooleanCheckbox itemLabel="#{bundle.DateChange}" id="cbDateChange" 
                                     widgetVar="cbDateChange"
                                     title="#{bundle.SearcheDateChange}" 
                                     value="#{_bean.model.dateChangeSearche}">
                <p:ajax event="change" update="pnDateChangeSearche"/>
            </p:selectBooleanCheckbox> 

            <h:panelGroup id="pnDateChangeSearche" styleClass="ui-grid-col-12">
                <p:panelGrid columns="2" layout="grid" columnClasses="ui-grid-col-1, ui-grid-col-11" rendered="#{_bean.model.dateChangeSearche}" styleClass="ui-grid-col-12">
                    <p:outputLabel value="#{bundle.With}:" style="float: right;"/>
                    <p:calendar value="#{_bean.model.dateChangeStart}" id="dateChangeStart"
                                widgetVar="dateChangeStartSearche"
                                navigator="true" yearRange="c-120:c+20"
                                locale="#{sessionBean.locale}"
                                required="#{_bean.model.dateChangeSearche and param['isRequired'] == 'true'}"
                                requiredMessage="#{bundle.Field} [#{bundle.DateChange}: #{bundle.With}] #{bundle.MustBeFilled}"
                                disabled="#{!_bean.model.dateChangeSearche}">
                    </p:calendar>
                </p:panelGrid>
                <p:panelGrid columns="2" layout="grid" columnClasses="ui-grid-col-1, ui-grid-col-11" rendered="#{_bean.model.dateChangeSearche}" styleClass="ui-grid-col-12">
                    <p:outputLabel value="#{bundle.At}:" style="float: right;"/>
                    <p:calendar value="#{_bean.model.dateChangeEnd}" id="dateChangeEnd"
                                widgetVar="dateChangeEndSearche"
                                navigator="true" yearRange="c-120:c+20"
                                locale="#{sessionBean.locale}"
                                required="#{_bean.model.dateChangeSearche and param['isRequired'] == 'true'}"
                                requiredMessage="#{bundle.Field} [#{bundle.DateChange}: #{bundle.At}] #{bundle.MustBeFilled}"
                                disabled="#{!_bean.model.dateChangeSearche}">
                    </p:calendar>
                </p:panelGrid>
            </h:panelGroup>

            <p:separator />

            <p:panelGrid layout="grid" columns="2" columnClasses="ui-grid-col-6, ui-grid-col-6" styleClass="ui-grid-col-12">
                <p:commandButton id="searcheBtn" value="#{bundle.Find}" title="#{bundle.MakeSearche}"
                                 icon="ui-icon-search" 
                                 styleClass="ui-grid-col-12"
                                 action="#{_bean.onSearcheItem}"
                                 update="#{_tblUpdate}"
                                 onstart="PF('statusDialog').show()"
                                 oncomplete="PF('statusDialog').hide(); initDND();">
                    <f:param name="isRequired" value="true"/>
                </p:commandButton>
                <p:commandButton value="#{bundle.Reset}" title="#{bundle.ResetSearcheCriteria}"
                                 icon="ui-icon-closethick"
                                 styleClass="ui-grid-col-12">
                    <p:ajax update="eastFRM" oncomplete="clearSearche(); initDND();"/>
                </p:commandButton>
            </h:panelGroup>

        </p:panelGrid>
    </p:panelGrid>

</ui:composition>