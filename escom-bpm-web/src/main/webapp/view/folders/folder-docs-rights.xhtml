<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <h:panelGrid columns="2">       
        <p:selectBooleanCheckbox value="#{foldersCardBean.editedItem.isInheritsAccessChilds}" 
                                 disabled="#{_bean.isReadOnly() or !_bean.isHaveRightChangeRight()}"
                                 valueChangeListener="#{foldersCardBean.onInheritsDocChange}">
            <p:ajax update="lbChBox docRightsGrid"/>
        </p:selectBooleanCheckbox>
        <p:outputLabel id="lbChBox" value="#{_bean.editedItem.inheritsAccessDocName}"/>
    </h:panelGrid>

    <h:panelGroup id="docRightsGrid" style="font-size: 80%;">
        <ui:repeat var="state" value="#{docsBean.metadatesObj.statesList}">             
            <p:accordionPanel activeIndex="null">
                <p:tab title="#{bundle.State}: #{state.name}" rendered="#{_bean.editedItem != null}" > 
                    <p:dataTable id="tblRight" value="#{_bean.getRightDocsForState(_bean.editedItem, state)}" var="right" 
                                 tableStyle="table-layout: auto;" styleClass="ui-grid-col-12"
                                 emptyMessage="#{bundle.EmptyTable}">
                        <p:column headerText="#{bundle.RightOwner}">
                            <h:outputText value="#{right.name}"/>
                        </p:column>
                        <p:column headerText="#{bundle.Read}" style="text-align: center;">
                            <p:selectBooleanCheckbox value="#{right.read}" disabled="true"/>
                        </p:column>
                        <p:column headerText="#{bundle.Change}" style="text-align: center;">
                            <p:selectBooleanCheckbox value="#{right.update}" disabled="true"/>
                        </p:column>
                        <p:column headerText="#{bundle.Creating}" style="text-align: center;">                                    
                            <p:selectBooleanCheckbox value="#{right.create}" disabled="true"/>
                        </p:column>                        
                        <p:column headerText="#{bundle.Remove}" style="text-align: center;">
                            <p:selectBooleanCheckbox value="#{right.delete}"  disabled="true"/>                                        
                        </p:column> 
                        <p:column headerText="#{bundle.ChangeRight}" style="text-align: center;">                                    
                            <p:selectBooleanCheckbox value="#{right.changeRight}" disabled="true"/>
                        </p:column>                         
                        <p:column headerText="#{bundle.Commands}" style="text-align: center;">
                            <p:panelGrid columns="2" layout="grid" columnClasses="ui-grid-col-12 without-spaces, ui-grid-col-12 without-spaces" styleClass="ui-grid-col-12 without-spaces">
                                <p:commandButton icon="ui-icon-document" title="#{bundle.Edit}" styleClass="without-spaces"
                                                 disabled="#{_bean.isReadOnly() or _bean.editedItem.isInheritsAccessChilds or !_bean.isHaveRightChangeRight()}"
                                                 actionListener="#{_bean.onEditDocRight(right)}" >
                                    <p:ajax event="dialogReturn" update="#{_frm}:mainTabView:docRightsGrid"
                                                listener="#{_bean.onCloseRightCard}"/>
                                </p:commandButton>
                                <p:commandButton icon="ui-icon-trash" title="#{bundle.Delete}" styleClass="without-spaces"
                                                 disabled="#{_bean.isReadOnly() or _bean.editedItem.isInheritsAccessChilds or !_bean.isHaveRightChangeRight()}"
                                                 update="tblRight"
                                                 actionListener="#{_bean.onDeleteRightDoc(right)}">
                                </p:commandButton>
                            </p:panelGrid>
                        </p:column>
                    </p:dataTable>
                    <p:panelGrid columns="1" layout="grid" columnClasses="ui-grid-col-12" styleClass="ui-panelgrid-blank">
                        <p:commandButton id="btnAddDocRight" value="#{bundle.Add}" 
                                         icon="ui-icon-circle-plus" style="float:right;"
                                         disabled="#{_bean.isReadOnly() or !_bean.isHaveRightChangeRight()}"
                                         rendered="#{!_bean.editedItem.isInheritsAccessChilds}" 
                                         actionListener="#{_bean.onAddDocRight(state)}">
                             <p:ajax event="dialogReturn" 
                                     update="#{_frm}:mainTabView:docRightsGrid"
                                     listener="#{_bean.onCloseRightCard}"/>
                        </p:commandButton>
                    </p:panelGrid>
                </p:tab>
            </p:accordionPanel>
        </ui:repeat>
    </h:panelGroup>

</ui:composition>

