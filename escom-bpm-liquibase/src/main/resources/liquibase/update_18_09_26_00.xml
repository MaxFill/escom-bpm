<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog 
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9" 
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">         

    <changeSet id="doc_change_right_role_owner_state_valid" author="filatov" context="initdata" runOnChange="true">
        <sql>
            UPDATE `access` SET `IsCreate`=0, `IsDelete`=0, `IsUpdate`=0 where ObjLink = 1 and State = 7 and ObjId = 16;
        </sql>
    </changeSet>
    
    <changeSet id="messages_add_Content" author="filatov" context="initdata" runOnChange="true">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="userMessages" columnName="Content" />
            </not>
        </preConditions>
        <addColumn tableName="userMessages">
            <column name="Content" type="varchar(2500)" >
                <constraints nullable="true"/>
            </column>
        </addColumn>
    </changeSet>
    
    <changeSet id="conditions_add_Params" author="filatov" context="initdata" runOnChange="true">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="conditions" columnName="Params" />
            </not>
        </preConditions>
        <addColumn tableName="conditions">
            <column name="Params" type="varchar(1024)" >
                <constraints nullable="true"/>
            </column>
        </addColumn>
    </changeSet>
    
    <changeSet id="conditions_add_condition_agreedUponEmployee" author="filatov" context="initdata" runOnChange="true">
        <sql>
            INSERT conditions(Id, Name, Method, Params) VALUES (4, N'AgreedUponEmployee', N'agreedUponEmployee', N'{\"staff\":null}');
        </sql>
    </changeSet>
    
    <changeSet id="scheme_add_name" author="filatov" context="initdata" runOnChange="true">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="schemes" columnName="Name" />
            </not>
        </preConditions>
        <addColumn tableName="schemes">
            <column name="Name" type="varchar(250)" >
                <constraints nullable="true"/>
            </column>
        </addColumn>
    </changeSet>
    
    <changeSet id="states_change_name_confirm_Eliminated" author="filatov" context="initdata" runOnChange="true">
        <sql>
            UPDATE `states` SET `Name`='Eliminated' where Id = 13;
        </sql>
    </changeSet>
    
</databaseChangeLog> 
